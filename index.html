<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Ahmed AL-Yousofi — GitHub Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#071029; --card:#0b1220; --muted:#9fb2d6; --accent:#36BCF7;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#06101b 0%, #071029 100%);color:#E6EEF8}
    header{display:flex;gap:18px;align-items:center;padding:28px;max-width:1100px;margin:0 auto}
    header img{width:96px;height:96px;border-radius:16px;object-fit:cover;border:2px solid rgba(255,255,255,0.04)}
    .wrap{max-width:1100px;margin:20px auto;padding:18px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:16px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    h3{margin:0 0 12px 0;color:var(--accent)}
    ul.repo{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}
    ul.repo li a{color:#CFE8FF;text-decoration:none}
    footer{max-width:1100px;margin:18px auto;color:var(--muted);font-size:13px;text-align:center}
    @media (max-width:520px){header{flex-direction:column;align-items:flex-start}}
  </style>
</head>
<body>
  <header>
    <img id="avatar" src="" alt="avatar">
    <div>
      <h1 id="name">Loading...</h1>
      <div id="bio" style="color:var(--muted)"></div>
      <div style="margin-top:8px"><a id="profileLink" href="#" target="_blank" style="color:var(--accent)">Open GitHub Profile</a></div>
    </div>
  </header>

  <div class="wrap">
    <div class="grid">
      <div class="card">
        <h3>Recent Repos</h3>
        <ul id="repos" class="repo"></ul>
      </div>

      <div class="card">
        <h3>Language Breakdown</h3>
        <canvas id="langChart"></canvas>
      </div>

      <div class="card">
        <h3>Commits Activity (last 90 days)</h3>
        <canvas id="commitsChart"></canvas>
      </div>
    </div>
  </div>

  <footer>Live dashboard • Data from GitHub REST API • Built for <strong>proAhmedUcv</strong></footer>

<script>
const USER = 'proAhmedUcv';
const API = 'https://api.github.com';
async function jfetch(u){ const r = await fetch(u); if(!r.ok) throw r; return r.json(); }

async function main(){
  try{
    const user = await jfetch(`${API}/users/${USER}`);
    document.getElementById('avatar').src = user.avatar_url;
    document.getElementById('name').innerText = user.name || USER;
    document.getElementById('bio').innerText = user.bio || '';
    document.getElementById('profileLink').href = user.html_url;

    const repos = await jfetch(`${API}/users/${USER}/repos?per_page=100&sort=pushed`);
    const recent = repos.slice(0,8);
    const ul = document.getElementById('repos');
    recent.forEach(r=>{
      const li = document.createElement('li');
      li.innerHTML = `<a href="${r.html_url}" target="_blank">${r.name}</a> — ★ ${r.stargazers_count} • forks: ${r.forks_count}`;
      ul.appendChild(li);
    });

    // language totals (first 30 repos)
    const langTotals = {};
    for(const r of repos.slice(0,30)){
      try{
        const langs = await jfetch(r.languages_url);
        for(const [k,v] of Object.entries(langs)) langTotals[k] = (langTotals[k]||0) + v;
      }catch(e){ /* ignore rate errors for demo */ }
    }
    const Lkeys = Object.keys(langTotals);
    const Lvals = Object.values(langTotals);
    new Chart(document.getElementById('langChart'), { type:'doughnut', data:{labels:Lkeys, datasets:[{data:Lvals}]}, options:{plugins:{legend:{position:'bottom'}}}});

    // commits from events (last 90 days)
    const events = await jfetch(`${API}/users/${USER}/events?per_page=100`);
    const days = 90;
    const counts = {};
    for(let i=0;i<days;i++){
      const d = new Date(); d.setDate(d.getDate()-i); counts[d.toISOString().slice(0,10)] = 0;
    }
    events.forEach(ev=>{
      const k = ev.created_at && ev.created_at.slice(0,10);
      if(k in counts && (ev.type==='PushEvent' || ev.type==='CommitCommentEvent')) counts[k]++;
    });
    const labels = Object.keys(counts).reverse();
    const data = Object.values(counts).reverse();
    new Chart(document.getElementById('commitsChart'), { type:'bar', data:{labels, datasets:[{label:'Events', data, barThickness:8}]}, options:{scales:{x:{ticks:{maxRotation:90}}}} });

  }catch(err){
    console.error(err);
    document.body.innerHTML = '<pre style="color:#f88">Error loading dashboard. Possibly rate-limited by GitHub API. See console.</pre>';
  }
}

main();
</script>
</body>
</html>
